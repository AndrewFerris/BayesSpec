}
}
}
z <- list(xi = xi,
log_spec_hat = log_spec_hat,
nloop = nloop,
nwarmup = nwarmup,
nexp_max = nexp_max,
x = x,
tmin = tmin,
sigmasqalpha = sigmasqalpha,
tau_prior_a = tau_prior_a,
tau_prior_b = tau_prior_b,
tau_up_limit = tau_up_limit,
prob_mm1 = prob_mm1,
step_size_max = step_size_max,
var_inflate = var_inflate,
nbasis = nbasis,
nfreq_hat = nfreq_hat)
return(z)
}
test2 <- adaptspec(2000,500,12,simulated_piecewise$V2)
str(test2)
warnings()
grid=zeros(nfreq_hat+1,nobs);
library("BayesSpec", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("astsa", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("mvtnorm", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
data <- read.csv("Case_9_T0_2000records.csv", header = TRUE)
setwd("/Users/andrewferris/Desktop")
data <- read.csv("Case_9_T0_2000records.csv", header = TRUE)
set.seed(5)
mod4 <- adaptspec(500, 100, 10, data$apb[1:1000])
mod3 <- adaptspec(500, 100, 10, data$apb[1:1000], plotting = 'meow')
mod2 <- adaptspec(500, 100, 10, data$apb[1:1000], plotting = FALSE)
mod5 <- adaptspec(500, 100, 10, data$apb[1:1000], plotting = 5)
mod6 <- adaptspec(500, 100, 10, data$apb[1:1000], plotting = meow)
mod1 <- adaptspec(500, 100, 10, data$apb[1:1000], plotting = TRUE)
mod1$nexp_curr == mod2$nexp_curr == mod3$nexp_curr == mod4$nexp_curr == mod5$nexp_curr
mod1$nexp_curr == mod2$nexp_curr
data(simulated_piecewise)
summary(simulated_piecewise)
View(simulated_piecewise)
simulated_piecewise <- cbind(simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,)
simulated_piecewise <- cbind(simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,
simulated_piecewise$V1,)
simulated_piecewise <- cbind(simulated_piecewise$V1,
simulated_piecewise$V2,
simulated_piecewise$V3,
simulated_piecewise$V4,
simulated_piecewise$V5,
simulated_piecewise$V6,
simulated_piecewise$V7,
simulated_piecewise$V8,
simulated_piecewise$V9,
simulated_piecewise$V10,
simulated_piecewise$V11,
simulated_piecewise$V12,
simulated_piecewise$V13,
simulated_piecewise$V14,
simulated_piecewise$V15,
simulated_piecewise$V16,
simulated_piecewise$V17,
simulated_piecewise$V18,
simulated_piecewise$V19,
simulated_piecewise$V20,
simulated_piecewise$V21,
simulated_piecewise$V22,
simulated_piecewise$V23,
simulated_piecewise$V24,
simulated_piecewise$V25,
simulated_piecewise$V26,
simulated_piecewise$V27,
simulated_piecewise$V28,
simulated_piecewise$V29,
simulated_piecewise$V30,
simulated_piecewise$V31,
simulated_piecewise$V32,
simulated_piecewise$V33,
simulated_piecewise$V34,
simulated_piecewise$V35,
simulated_piecewise$V36,
simulated_piecewise$V37,
simulated_piecewise$V38,
simulated_piecewise$V39,
simulated_piecewise$V40,
simulated_piecewise$V41,
simulated_piecewise$V42,
simulated_piecewise$V43,
simulated_piecewise$V44,
simulated_piecewise$V45,
simulated_piecewise$V46,
simulated_piecewise$V47,
simulated_piecewise$V48,
simulated_piecewise$V49,
simulated_piecewise$V50)
View(simulated_piecewise)
names(simulated_piecewise)
sp <- cbind(simulated_piecewise$V1,
simulated_piecewise$V2,
simulated_piecewise$V3,
simulated_piecewise$V4,
simulated_piecewise$V5,
simulated_piecewise$V6,
simulated_piecewise$V7,
simulated_piecewise$V8,
simulated_piecewise$V9,
simulated_piecewise$V10,
simulated_piecewise$V11,
simulated_piecewise$V12,
simulated_piecewise$V13,
simulated_piecewise$V14,
simulated_piecewise$V15,
simulated_piecewise$V16,
simulated_piecewise$V17,
simulated_piecewise$V18,
simulated_piecewise$V19,
simulated_piecewise$V20,
simulated_piecewise$V21,
simulated_piecewise$V22,
simulated_piecewise$V23,
simulated_piecewise$V24,
simulated_piecewise$V25,
simulated_piecewise$V26,
simulated_piecewise$V27,
simulated_piecewise$V28,
simulated_piecewise$V29,
simulated_piecewise$V30,
simulated_piecewise$V31,
simulated_piecewise$V32,
simulated_piecewise$V33,
simulated_piecewise$V34,
simulated_piecewise$V35,
simulated_piecewise$V36,
simulated_piecewise$V37,
simulated_piecewise$V38,
simulated_piecewise$V39,
simulated_piecewise$V40,
simulated_piecewise$V41,
simulated_piecewise$V42,
simulated_piecewise$V43,
simulated_piecewise$V44,
simulated_piecewise$V45,
simulated_piecewise$V46,
simulated_piecewise$V47,
simulated_piecewise$V48,
simulated_piecewise$V49,
simulated_piecewise$V50)
data(simulated_piecewise)
sp <- cbind(simulated_piecewise$V1,
simulated_piecewise$V2,
simulated_piecewise$V3,
simulated_piecewise$V4,
simulated_piecewise$V5,
simulated_piecewise$V6,
simulated_piecewise$V7,
simulated_piecewise$V8,
simulated_piecewise$V9,
simulated_piecewise$V10,
simulated_piecewise$V11,
simulated_piecewise$V12,
simulated_piecewise$V13,
simulated_piecewise$V14,
simulated_piecewise$V15,
simulated_piecewise$V16,
simulated_piecewise$V17,
simulated_piecewise$V18,
simulated_piecewise$V19,
simulated_piecewise$V20,
simulated_piecewise$V21,
simulated_piecewise$V22,
simulated_piecewise$V23,
simulated_piecewise$V24,
simulated_piecewise$V25,
simulated_piecewise$V26,
simulated_piecewise$V27,
simulated_piecewise$V28,
simulated_piecewise$V29,
simulated_piecewise$V30,
simulated_piecewise$V31,
simulated_piecewise$V32,
simulated_piecewise$V33,
simulated_piecewise$V34,
simulated_piecewise$V35,
simulated_piecewise$V36,
simulated_piecewise$V37,
simulated_piecewise$V38,
simulated_piecewise$V39,
simulated_piecewise$V40,
simulated_piecewise$V41,
simulated_piecewise$V42,
simulated_piecewise$V43,
simulated_piecewise$V44,
simulated_piecewise$V45,
simulated_piecewise$V46,
simulated_piecewise$V47,
simulated_piecewise$V48,
simulated_piecewise$V49,
simulated_piecewise$V50)
View(sp)
sp <- rbind(simulated_piecewise$V1,
simulated_piecewise$V2,
simulated_piecewise$V3,
simulated_piecewise$V4,
simulated_piecewise$V5,
simulated_piecewise$V6,
simulated_piecewise$V7,
simulated_piecewise$V8,
simulated_piecewise$V9,
simulated_piecewise$V10,
simulated_piecewise$V11,
simulated_piecewise$V12,
simulated_piecewise$V13,
simulated_piecewise$V14,
simulated_piecewise$V15,
simulated_piecewise$V16,
simulated_piecewise$V17,
simulated_piecewise$V18,
simulated_piecewise$V19,
simulated_piecewise$V20,
simulated_piecewise$V21,
simulated_piecewise$V22,
simulated_piecewise$V23,
simulated_piecewise$V24,
simulated_piecewise$V25,
simulated_piecewise$V26,
simulated_piecewise$V27,
simulated_piecewise$V28,
simulated_piecewise$V29,
simulated_piecewise$V30,
simulated_piecewise$V31,
simulated_piecewise$V32,
simulated_piecewise$V33,
simulated_piecewise$V34,
simulated_piecewise$V35,
simulated_piecewise$V36,
simulated_piecewise$V37,
simulated_piecewise$V38,
simulated_piecewise$V39,
simulated_piecewise$V40,
simulated_piecewise$V41,
simulated_piecewise$V42,
simulated_piecewise$V43,
simulated_piecewise$V44,
simulated_piecewise$V45,
simulated_piecewise$V46,
simulated_piecewise$V47,
simulated_piecewise$V48,
simulated_piecewise$V49,
simulated_piecewise$V50)
View(sp)
View(simulated_piecewise)
write.csv(simulated_piecewise, "simulated_piecewise.csv", header = TRUE, row.names = FALSE)
write.csv(simulated_piecewise, "simulated_piecewise.csv", row.names = FALSE)
getwd()
a <- NULL
col(simulated_piecewise)
a <- NULL
for (i in 1:1024){
a <- rbind(a,simulated_piecewise[,i])
}
View(a)
dim(simulated_piecewise)
dim(a)
a <- NULL
for (i in 1:1024){
a <- cbind(a,simulated_piecewise[,i])
}
dim(a)
a <- NULL
a <- stack(simulated_piecewise)
View(a)
simulated_piecewise <- a$values
class(simulated_piecewise)
simulated_piecewise <- as.vector(simulated_piecewise)
class(simulated_piecewise)
names(simulated_piecewise)
save(simulated_piecewise, file = "simulated_piecewise.Rda")
save(simulated_piecewise, file = "simulated_piecewise.rda")
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
data(intracranial_eeg)
View(head(intracranial_eeg))
ieeg <- intracranial_eeg[,1]
ieeg <- as.vector(intracranial_eeg[,1])
intracranial_eeg <- as.vector(intracranial_eeg[,1])
save(intracranial_eeg, "intracranial_eeg.rda")
save(intracranial_eeg, file = "intracranial_eeg.rda")
getwd()
getwd()
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
help(BayesSpec)
??BayesSpec
help("adaptspec")
data("intracranial_eeg")
View(intracranial_eeg)
head(intracranial_eeg)
dim(intracranial_eeg)
length(intracranial_eeg)
set.seed(346)
phi_true <- matrix(list(),3,1)
phi_true[[1]] <- .9
phi_true[[2]] <- c(1.69, -.81)
phi_true[[3]] <- c(1.32, -.81)
sd_true <- rep(1,3)
x1 <- arima.sim(list(order=c(1,0,0), ar=phi_true[[1]]),512,sd=sd_true[1])
x2 <- arima.sim(list(order=c(2,0,0), ar=phi_true[[2]]),256,sd=sd_true[2])
x3 <- arima.sim(list(order=c(2,0,0), ar=phi_true[[3]]),256,sd=sd_true[3])
x <- c(x1, x2, x3)
plot.ts(x)
true_spec_dens <- matrix(list(),3,1)
for (j in 1:3){
true_spec_dens[[j]] <- arma.spec(ar=phi_true[[j]],var.noise = sd_true[j]^2,log="no")
}
View(true_spec_dens)
library(astsa)
true_spec_dens <- matrix(list(),3,1)
for (j in 1:3){
true_spec_dens[[j]] <- arma.spec(ar=phi_true[[j]],var.noise = sd_true[j]^2,log="no")
}
View(true_spec_dens)
simulated_piecewise <- x
getwd()
save(simulated_piecewise, file = "simulated_piecewise.rda")
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library("BayesSpec", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
model <- adaptspec(2000,500,10,simulated_data)
model <- adaptspec(2000,500,10,simulated_piecewise)
str(model)
persp(seq(10, 300, 5), seq(10, 300, 5), z, phi = 45, theta = 45,
xlab = "X Coordinate (feet)", ylab = "Y Coordinate (feet)",
main = "Surface elevation data"
)
persp(seq(10, 300, 5), seq(10, 300, 5), phi = 45, theta = 45,
xlab = "X Coordinate (feet)", ylab = "Y Coordinate (feet)",
main = "Surface elevation data"
)
View(model$xi)
View(as.matrix(model$xi))
output <- matrix(unlist(model$xi), ncol = 10, byrow = TRUE)
View(output)
persp(seq(10, 300, 5), seq(10, 300, 5), z = output, phi = 45, theta = 45,
xlab = "X Coordinate (feet)", ylab = "Y Coordinate (feet)",
main = "Surface elevation data"
)
xi <- matrix(unlist(model$xi), ncol = 10, byrow = TRUE)
persp(seq(10, 300, 5), seq(10, 300, 5), z = xi, phi = 45, theta = 45,
xlab = "X Coordinate (feet)", ylab = "Y Coordinate (feet)",
main = "Surface elevation data"
)
persp(seq(10, 300, 5), seq(10, 300, 5), z = seq(10, 300, 5), phi = 45, theta = 45,
xlab = "X Coordinate (feet)", ylab = "Y Coordinate (feet)",
main = "Surface elevation data"
)
range(xi)
persp(seq(1, 1024, 5), seq(1, 1024, 5), z = xi, phi = 45, theta = 45,
xlab = "X Coordinate (feet)", ylab = "Y Coordinate (feet)",
main = "Surface elevation data"
)
?outer
library(BayesSpec)
detach("package:BayesSpec", unload=TRUE)
library("BayesSpec", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library(BayesSpec)
data("simulated_piecewise")
post_beta <- function(j, nseg_temp, x, xi_temp, tau_temp,
token_information){
#   j=1 #used for debugging
#   nseg_temp = nseg_temp[j] # used for debugging
#   tau_temp = tau_temp[j] # used for debugging
var_inflate <- token_information$var_inflate
nbeta <- token_information$nbeta
nbasis <- token_information$nbasis
sigmasqalpha <- token_information$sigmasqalpha
nfreq <- floor(nseg_temp/2)
freq <- (0:nfreq)/(2*nfreq)
if (j>1){
dft <- fft(x[(xi_temp[j-1]+1):xi_temp[j]])/sqrt(nseg_temp)
y <- dft[1:(nfreq+1)]
prdgrm <- abs(y)^2
} else {
dft <- fft(x[1:xi_temp[j]])/sqrt(nseg_temp)
y <- dft[1:(nfreq+1)]
prdgrm <- abs(y)^2
}
nu_mat <- lin_basis_func(freq, nbeta)
nn <- nseg_temp
ytemp <- prdgrm
param<-rep(0,nbeta)
precs <- c(1/sigmasqalpha,rep(1/tau_temp,nbasis))
opt <- trust(beta_derivs, param, rinit=1, rmax=100, parscale=rep(1,nbeta),
iterlim = 100, fterm = sqrt(.Machine$double.eps),
mterm = sqrt(.Machine$double.eps),
minimize = FALSE, blather = FALSE, nn, nu_mat, prdgrm, precs)
beta_mean <- opt$argument
beta_var <- -solve(opt$hessian)
list(beta_mean = beta_mean, beta_var = beta_var, nu_mat = nu_mat, prdgrm = prdgrm)
}
return(cbind(rep(1,n),omega))
return(cbind(rep(1,n),omega))
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
debugSource('~/Documents/bananas.R', echo=TRUE)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
View(simulated_piecewise)
length(simulated_piecewise)
length(simulated_piecewise[1:200])
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
library(BayesSpec)
time_1 <- Sys.time()
time_1
time_1 <- Sys.time()
data(simulated_piecewise)
model1 <- adaptspec(nloop = 100, nwarmup = 25,
nexp_max = 10, x = simulated_piecewise[1:128])
str(model1)
summary(model1$nexp_curr)
plot(model1$nexp_curr)
time_2 <- Sys.time()
time_1
time_2
time_2 - time_1
time_1 <- Sys.time()
data(simulated_piecewise)
model1 <- adaptspec(nloop = 80, nwarmup = 20,
nexp_max = 5, x = simulated_piecewise[1:100])
str(model1)
summary(model1$nexp_curr)
plot(model1$nexp_curr)
time_2 <- Sys.time()
time_1
time_2
time_2 - time_1
library(BayesSpec)
